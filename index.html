<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tama Fishing Ultimate</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <style>
        :root { --main-blue: #0ea5e9; --dark-bg: #0f172a; --card-bg: rgba(30, 41, 59, 0.7); }
        body {
            background: var(--dark-bg); color: white; font-family: 'Segoe UI', sans-serif;
            margin: 0; padding: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden;
        }
        #ton-connect { position: absolute; top: 15px; right: 15px; z-index: 100; transform: scale(0.9); }
        .tab-content { flex: 1; display: none; padding: 20px; overflow-y: auto; padding-bottom: 100px; }
        .active { display: block; }
        
        /* –ü—Ä–æ—Ñ–∏–ª—å —Å–≤–µ—Ä—Ö—É */
        .user-stats { background: var(--card-bg); padding: 15px; display: flex; justify-content: space-around; font-size: 14px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .stat-val { color: var(--main-blue); font-weight: bold; }

        /* –ö–Ω–æ–ø–∫–∞ –ª–æ–≤–ª–∏ */
        .fish-circle {
            width: 180px; height: 180px; background: radial-gradient(circle, #0ea5e9, #2563eb);
            border-radius: 50%; margin: 30px auto; display: flex; justify-content: center;
            align-items: center; border: 6px solid rgba(255,255,255,0.2);
            box-shadow: 0 0 30px rgba(14, 165, 233, 0.4); cursor: pointer; transition: 0.1s;
        }
        .fish-circle:active { transform: scale(0.92); }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞ –∏ —Ç–æ–ø–∞ */
        .card { background: var(--card-bg); padding: 15px; border-radius: 16px; margin-bottom: 12px; border: 1px solid rgba(255,255,255,0.05); text-align: left; }
        .btn-buy { background: var(--main-blue); color: white; border: none; padding: 10px 20px; border-radius: 10px; width: 100%; font-weight: bold; margin-top: 10px; }
        
        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav-bar {
            display: flex; position: fixed; bottom: 0; width: 100%; background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px); border-top: 1px solid rgba(255,255,255,0.1); padding-bottom: 20px;
        }
        .nav-item { flex: 1; text-align: center; padding: 15px 0; font-size: 12px; color: #94a3b8; cursor: pointer; }
        .nav-item.active-nav { color: var(--main-blue); }
    </style>
</head>
<body>

    <div id="ton-connect"></div>

    <div class="user-stats">
        <div>üí∞ <span id="ui-bal" class="stat-val">...</span> TC</div>
        <div>üéí <span id="ui-fish" class="stat-val">...</span> –∫–≥</div>
        <div>üîã <span id="ui-energy" class="stat-val">...</span></div>
    </div>

    <div id="game" class="tab-content active">
        <h3 style="text-align:center;">üé£ –†–´–ë–ê–õ–ö–ê</h3>
        <div class="fish-circle" id="catch-btn"><b>–ó–ê–ë–†–û–°</b></div>
        <div class="card" style="text-align:center;">
            <div id="status">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–±—Ä–æ—Å–∞</div>
            <div style="font-size:12px; color:#64748b; margin-top:5px;">–£–¥–æ—á–∫–∞: <span id="ui-dur">...</span>%</div>
        </div>
    </div>

    <div id="shop" class="tab-content">
        <h3>üõí –ú–ê–ì–ê–ó–ò–ù</h3>
        <div class="card">
            <b>üîß –†–µ–º–æ–Ω—Ç —Å–Ω–∞—Å—Ç–µ–π</b><br><small>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ 100%</small>
            <button class="btn-buy" onclick="act('buy_repair')">10 TC</button>
        </div>
        <div class="card">
            <b>üçû –ü—Ä–∏–º–∞–Ω–∫–∞ (10 —à—Ç)</b><br><small>–í–µ—Å —É–ª–æ–≤–∞ —Ö2</small>
            <button class="btn-buy" onclick="act('buy_bait')">25 TC</button>
        </div>
        <div class="card">
            <b>üåä –õ–∏—Ü–µ–Ω–∑–∏—è: –†–µ–∫–∞</b><br><small>–î–æ—Å—Ç—É–ø –∫ –∫—Ä—É–ø–Ω–æ–π —Ä—ã–±–µ</small>
            <button class="btn-buy" onclick="act('buy_lic_river')">500 TC</button>
        </div>
    </div>

    <div id="leaderboard" class="tab-content">
        <h3>üèÜ –¢–û–ü –ò–ì–†–û–ö–û–í</h3>
        <div id="top-list">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>

    <div id="info" class="tab-content">
        <h3>‚ÑπÔ∏è –ò–ù–§–û–†–ú–ê–¶–ò–Ø</h3>
        <div class="card">
            <p>–ö—É—Ä—Å: 1 –∫–≥ —Ä—ã–±—ã = 0.1 TC</p>
            <p>–í—ã–≤–æ–¥: –æ—Ç 30,000 TC</p>
            <p>–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞: 8.1 Ultimate</p>
        </div>
        <button class="btn-buy" style="background:#334155;" onclick="act('sell_fish')">‚öñÔ∏è –ü–†–û–î–ê–¢–¨ –í–ï–°–¨ –£–õ–û–í</button>
    </div>

    <div class="nav-bar">
        <div class="nav-item active-nav" onclick="tab('game', this)">üé£ –ò–≥—Ä–∞</div>
        <div class="nav-item" onclick="tab('shop', this)">üõí –õ–∞–≤–∫–∞</div>
        <div class="nav-item" onclick="tab('leaderboard', this)">üèÜ –¢–æ–ø</div>
        <div class="nav-item" onclick="tab('info', this)">‚ÑπÔ∏è –ò–Ω—Ñ–æ</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
            manifestUrl: 'https://criptocit-jpg.github.io/tama-fishing/tonconnect-manifest.json',
            buttonRootId: 'ton-connect'
        });

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –±–æ—Ç—É
        function act(type) {
            const data = { action: type, wallet: tonConnectUI.account ? tonConnectUI.account.address : null };
            tg.sendData(JSON.stringify(data));
        }

        function tab(id, el) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active-nav'));
            document.getElementById(id).classList.add('active');
            el.classList.add('active-nav');
            if(id === 'leaderboard') act('get_top'); // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ç–æ–ø –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
        }

        // –ü–û–õ–£–ß–ï–ù–ò–ï –î–ê–ù–ù–´–• –û–¢ –ë–û–¢–ê
        tg.onEvent('main_button_pressed', () => {}); // –ó–∞–≥–ª—É—à–∫–∞

        // –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ initDataUnsafe
        const user = tg.initDataUnsafe.user;
        
        document.getElementById('catch-btn').onclick = () => {
            tg.HapticFeedback.impactOccurred('medium');
            act('catch_fish');
        };

        // –í–Ω–∏–º–∞–Ω–∏–µ: –ß—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è–ª–∏—Å—å, –±–æ—Ç –ø—Ä–∏—à–ª–µ—Ç –æ—Ç–≤–µ—Ç –≤ —á–∞—Ç.
    </script>
</body>
</html>
