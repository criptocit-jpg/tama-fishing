<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Tamacoin Gold 3.5.1</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --gold: #FFD700; --blue: #0088CC; --bg: #050810; --glass: rgba(255,255,255,0.08); --wood: #2c1b10; }
        body { margin: 0; background: var(--bg); color: #fff; font-family: -apple-system, sans-serif; overflow: hidden; user-select: none; }
        
        .page { display: none; height: 100vh; padding: 20px; box-sizing: border-box; flex-direction: column; padding-bottom: 90px; overflow-y: auto; }
        .active { display: flex; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* –®–∞–ø–∫–∞ –∏ –£—Ä–æ–≤–Ω–∏ */
        .header-ui { text-align: center; margin-bottom: 15px; }
        .level-badge { background: var(--gold); color: #000; padding: 3px 12px; border-radius: 20px; font-size: 11px; font-weight: 900; display: inline-block; margin-bottom: 8px; box-shadow: 0 0 10px rgba(255,215,0,0.3); }
        .balance-val { font-size: 42px; font-weight: 900; color: var(--gold); text-shadow: 0 0 20px rgba(255,215,0,0.2); }
        .timer-box { font-size: 10px; color: #8892b0; font-family: monospace; margin-top: 5px; }

        /* –ò–≥—Ä–æ–≤–∞—è –∑–æ–Ω–∞ –∏ –ö–∞–ø—á–∞ */
        .fishing-zone { flex-grow: 1; position: relative; background: rgba(0,0,0,0.3); border-radius: 25px; border: 1px dashed rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center; overflow: hidden; }
        #fishCaptcha { position: absolute; width: 70px; height: 70px; cursor: pointer; display: none; z-index: 1000; filter: drop-shadow(0 0 15px var(--blue)); }
        #castHint { color: #444; font-size: 14px; text-align: center; padding: 20px; }

        /* –ú–∞–≥–∞–∑–∏–Ω */
        .shop-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        .item-card { background: var(--glass); border-radius: 18px; padding: 15px; text-align: center; border: 1px solid rgba(255,255,255,0.05); }
        .item-card span { font-size: 28px; display: block; }
        .price { color: var(--gold); font-weight: 800; font-size: 12px; margin: 5px 0; display: block; }

        /* –î–µ—Ä–µ–≤—è–Ω–Ω–∞—è –ø–ª–∞—à–∫–∞ (Custom Alert) */
        .custom-alert { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.8); width: 280px; background: linear-gradient(135deg, #3d2b1f 0%, #1a0f08 100%); border: 3px solid #8b5a2b; box-shadow: 0 0 30px rgba(0,0,0,0.9); border-radius: 20px; padding: 20px; text-align: center; z-index: 10000; display: none; opacity: 0; transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .custom-alert.show { display: block; opacity: 1; transform: translate(-50%, -50%) scale(1); }
        .custom-alert h3 { color: var(--gold); font-size: 18px; margin: 0 0 10px 0; border-bottom: 1px solid rgba(255,215,0,0.2); padding-bottom: 8px; }
        .custom-alert p { color: #e0cda9; font-size: 14px; margin: 15px 0; line-height: 1.4; }
        .alert-btn { background: #8b5a2b; color: #fff; border: none; padding: 10px 30px; border-radius: 8px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 0 #5d3a1d; }

        /* –ö–Ω–æ–ø–∫–∏ –∏ –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .btn { border: none; border-radius: 20px; font-weight: 800; font-size: 16px; cursor: pointer; width: 100%; transition: 0.2s; }
        .btn-blue { background: var(--blue); color: #fff; padding: 18px; box-shadow: 0 5px 15px rgba(0,136,204,0.3); }
        .btn-gold { background: var(--gold); color: #000; padding: 15px; margin-bottom: 10px; }
        .btn:disabled { opacity: 0.5; transform: scale(1) !important; }

        .navbar { position: fixed; bottom: 0; left: 0; width: 100%; height: 80px; background: rgba(0,0,0,0.95); display: flex; border-top: 1px solid #222; backdrop-filter: blur(10px); }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 10px; color: #555; text-decoration: none; font-weight: 700; }
        .nav-item.active { color: var(--gold); }
        .nav-item span { font-size: 22px; margin-bottom: 4px; }
    </style>
</head>
<body>

<div id="myAlert" class="custom-alert">
    <h3 id="alertTitle">–°–û–í–ï–¢ –†–´–ë–ê–ö–ê</h3>
    <p id="alertText">–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è...</p>
    <button class="alert-btn" onclick="closeAlert()">–ü–û–ù–Ø–õ</button>
</div>

<div id="game" class="page active">
    <div class="header-ui">
        <div id="u-level" class="level-badge">–ó–ê–ì–†–£–ó–ö–ê...</div>
        <div class="balance-val" id="b-val">0 TC</div>
        <div class="timer-box" id="timers">–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø...</div>
    </div>

    <div class="fishing-zone" id="zone">
        <img src="https://cdn-icons-png.flaticon.com/512/2271/2271101.png" id="fishCaptcha" onclick="confirmCatch()">
        <div id="castHint">–ù–∞–∂–º–∏ "–ó–ê–ë–†–û–°–ò–¢–¨", –¥–æ–∂–¥–∏—Å—å –∫–ª—ë–≤–∞ –∏ –∂–º–∏ –Ω–∞ —Ä—ã–±—É!</div>
    </div>

    <div style="background:var(--glass); padding:12px; border-radius:18px; margin: 15px 0; display:flex; justify-content:space-between; align-items:center;">
        <div style="font-size:12px;"><b>–ì–õ–£–ë–û–ö–û–í–û–î–ù–´–ô –†–ï–ñ–ò–ú</b><br><small style="color:#888">–£–ª–æ–≤ x10 | –†–∏—Å–∫ –æ–±—Ä—ã–≤–∞</small></div>
        <input type="checkbox" id="isDeep" style="width:24px; height:24px;">
    </div>

    <button class="btn btn-gold" id="btnBonus" onclick="doAction('get_bonus')">–ï–ñ–ï–î–ù–ï–í–ù–´–ô –ë–û–ù–£–° üéÅ</button>
    <button class="btn btn-blue" id="btnCast" onclick="startFishing()">–ó–ê–ë–†–û–°–ò–¢–¨ –£–î–û–ß–ö–£ üé£</button>
</div>

<div id="shop" class="page">
    <h2>–¢–û–†–ì–û–í–´–ô –£–ó–ï–õ üõí</h2>
    <div style="background:var(--glass); padding:20px; border-radius:20px; text-align:center; border: 1px solid var(--blue);">
        <small style="color:#8892b0">–†–´–ë–ê –í –°–ê–î–ö–ï</small><br>
        <b style="font-size:32px; color:#fff;"><span id="shop-fish">0.00</span> –ö–ì</b><br><br>
        <button class="btn btn-blue" onclick="doAction('sell_fish')">–ü–†–û–î–ê–¢–¨ –í–ï–°–¨ –£–õ–û–í</button>
    </div>

    <div class="shop-grid">
        <div class="item-card"><span>üé£</span><small>–°–ø–∏–Ω–Ω–∏–Ω–≥ Carbon</small><span class="price">50 Stars</span><button class="btn btn-blue" style="padding:5px; font-size:10px;">–ö–£–ü–ò–¢–¨</button></div>
        <div class="item-card"><span>üîã</span><small>–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫</small><span class="price">10 Stars</span><button class="btn btn-blue" style="padding:5px; font-size:10px;">–ö–£–ü–ò–¢–¨</button></div>
        <div class="item-card"><span>üì°</span><small>–≠—Ö–æ–ª–æ—Ç</small><span class="price">120 Stars</span><button class="btn btn-blue" style="padding:5px; font-size:10px;">–ö–£–ü–ò–¢–¨</button></div>
        <div class="item-card"><span>üëë</span><small>–ó–æ–ª–æ—Ç–æ–π —á–µ—Ä–≤—å</small><span class="price">100 Stars</span><button class="btn btn-blue" style="padding:5px; font-size:10px;">–ö–£–ü–ò–¢–¨</button></div>
    </div>
</div>

<div id="info" class="page">
    <h2>–ö–õ–£–ë –†–´–ë–ê–ö–û–í üë•</h2>
    <div style="background:var(--glass); padding:15px; border-radius:15px; margin-bottom:15px;">
        <h3>–†–ï–§–ï–†–ê–õ–¨–ù–ê–Ø –ü–†–û–ì–†–ê–ú–ú–ê</h3>
        <p style="font-size:12px; color:#888;">–ó–∞ –∫–∞–∂–¥–æ–≥–æ –¥—Ä—É–≥–∞ ‚Äî 1 –ö–æ—Ä–æ–±–∫–∞ –£–¥–∞—á–∏!</p>
        <code id="ref-link" style="display:block; background:#000; padding:12px; border-radius:10px; color:var(--gold); font-size:11px; margin: 10px 0;">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Å—ã–ª–∫–∏...</code>
        <button class="btn btn-gold" onclick="copyRef()">–ö–û–ü–ò–†–û–í–ê–¢–¨ –°–°–´–õ–ö–£</button>
    </div>
    <div style="background:var(--glass); padding:15px; border-radius:15px;">
        <h3>–°–¢–ê–¢–ò–°–¢–ò–ö–ê</h3>
        <p style="font-size:13px;">–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏: <b id="u-art">0/5</b></p>
    </div>
</div>

<nav class="navbar">
    <a href="#" class="nav-item active" onclick="showPage('game', this)"><span>üéÆ</span>–ò–ì–†–ê</a>
    <a href="#" class="nav-item" onclick="showPage('shop', this)"><span>üõí</span>–ú–ê–†–ö–ï–¢</a>
    <a href="#" class="nav-item" onclick="showPage('info', this)"><span>üë•</span>–ö–õ–£–ë</a>
</nav>

<script>
    const tg = window.Telegram.WebApp;
    const API = 'https://–¢–í–û–ô-–°–ï–†–í–ï–†.onrender.com/api/action'; // –ó–ê–ú–ï–ù–ò –ù–ê –°–í–û–ô URL
    let nextBonusTime = 0;
    let isFishing = false;

    // –ö–∞—Å—Ç–æ–º–Ω—ã–π –∞–ª–µ—Ä—Ç (–¥–µ—Ä–µ–≤—è–Ω–Ω–∞—è –ø–ª–∞—à–∫–∞)
    function showAlert(text, title = "–°–û–í–ï–¢ –†–´–ë–ê–ö–ê") {
        document.getElementById('alertTitle').innerText = title;
        document.getElementById('alertText').innerText = text;
        document.getElementById('myAlert').classList.add('show');
        tg.HapticFeedback.notificationOccurred('success');
    }
    function closeAlert() { document.getElementById('myAlert').classList.remove('show'); }

    function showPage(id, el) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        el.classList.add('active');
    }

    async function doAction(action, captchaPassed = false) {
        try {
            const res = await fetch(API, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    userId: tg.initDataUnsafe?.user?.id || "7883085758",
                    userName: tg.initDataUnsafe?.user?.first_name || "–†—ã–±–∞–∫",
                    action, captchaPassed, isDeep: document.getElementById('isDeep').checked
                })
            });
            const d = await res.json();
            if(d.msg) showAlert(d.msg, action === 'catch_fish' ? "–£–õ–û–í!" : "–ò–ù–§–û");
            updateUI(d);
        } catch(e) { console.error(e); }
    }

    function updateUI(d) {
        const b = Math.floor(d.b);
        document.getElementById('b-val').innerText = b.toLocaleString() + " TC";
        document.getElementById('shop-fish').innerText = d.fish.toFixed(2);
        document.getElementById('u-art').innerText = `${d.artifacts.length}/5`;
        document.getElementById('ref-link').innerText = `https://t.me/–¢–í–û–ô_–ë–û–¢?start=${d.id}`;
        
        // –£—Ä–æ–≤–Ω–∏
        const levels = [
            {n: "–õ–ï–ì–ï–ù–î–ê üëë", v: 100000}, {n: "–ú–ê–°–¢–ï–† üö¢", v: 50000},
            {n: "–ü–†–û–§–ò üõ•Ô∏è", v: 10000}, {n: "–†–´–ë–ê–ö üõ∂", v: 3000}, {n: "–ù–û–í–ò–ß–û–ö üé£", v: 0}
        ];
        document.getElementById('u-level').innerText = levels.find(l => b >= l.v).n;
        nextBonusTime = d.lastBonus + 86400000;
    }

    function startFishing() {
        if(isFishing) return;
        isFishing = true;
        document.getElementById('btnCast').disabled = true;
        document.getElementById('castHint').innerText = "–ñ–î–Å–ú –ü–û–ö–õ–Å–í–ö–£...";
        
        setTimeout(() => {
            const fish = document.getElementById('fishCaptcha');
            const zone = document.getElementById('zone');
            fish.style.top = Math.random() * (zone.offsetHeight - 80) + "px";
            fish.style.left = Math.random() * (zone.offsetWidth - 80) + "px";
            fish.style.display = "block";
            document.getElementById('castHint').innerText = "–ü–û–î–°–ï–ö–ê–ô! –ñ–ú–ò –ù–ê –†–´–ë–£!";
            tg.HapticFeedback.impactOccurred('medium');
        }, 1500);
    }

    function confirmCatch() {
        document.getElementById('fishCaptcha').style.display = "none";
        document.getElementById('btnCast').disabled = false;
        document.getElementById('castHint').innerText = "–ù–∞–∂–º–∏ '–ó–ê–ë–†–û–°–ò–¢–¨', –¥–æ–∂–¥–∏—Å—å –∫–ª—ë–≤–∞ –∏ –∂–º–∏ –Ω–∞ —Ä—ã–±—É!";
        isFishing = false;
        doAction('catch_fish', true);
    }

    function copyRef() {
        const link = document.getElementById('ref-link').innerText;
        navigator.clipboard.writeText(link);
        showAlert("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞! –û—Ç–ø—Ä–∞–≤—å –µ—ë –¥—Ä—É–≥—É.");
    }

    setInterval(() => {
        const now = Date.now();
        const bRem = nextBonusTime - now;
        const bText = bRem > 0 ? new Date(bRem).toISOString().substr(11,8) : "–ì–û–¢–û–í! üéÅ";
        document.getElementById('timers').innerText = `–ë–û–ù–£–° –ß–ï–†–ï–ó: ${bText}`;
        
        const hour = new Date().getHours();
        if(hour === 19) document.getElementById('timers').innerText += " | –ó–û–õ–û–¢–û–ô –ß–ê–° üî•";
    }, 1000);

    doAction('load');
    tg.expand();
</script>
</body>
</html>
