<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tama Fishing PRO</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <style>
        :root { --main-blue: #0ea5e9; --dark-bg: #0f172a; }
        body {
            background: var(--dark-bg); color: white; font-family: 'Segoe UI', sans-serif;
            margin: 0; padding: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden;
        }
        #ton-connect { position: absolute; top: 15px; right: 15px; z-index: 100; }
        .tab-content { flex: 1; display: none; padding: 20px; overflow-y: auto; text-align: center; }
        .active { display: block; }
        
        /* –ì–ª–∞–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ */
        .fish-circle {
            width: 200px; height: 200px; background: linear-gradient(135deg, #0ea5e9, #2563eb);
            border-radius: 50%; margin: 50px auto; display: flex; justify-content: center;
            align-items: center; border: 8px solid rgba(255,255,255,0.1);
            box-shadow: 0 0 40px rgba(14, 165, 233, 0.4); cursor: pointer;
        }
        .fish-circle:active { transform: scale(0.95); }

        /* –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é */
        .nav-bar {
            display: flex; background: rgba(30, 41, 59, 0.9);
            backdrop-filter: blur(10px); border-top: 1px solid rgba(255,255,255,0.1);
            padding: 10px 0; padding-bottom: 25px;
        }
        .nav-item { flex: 1; text-align: center; font-size: 12px; color: #94a3b8; cursor: pointer; }
        .nav-item.active-nav { color: var(--main-blue); font-weight: bold; }
        
        .stat-card { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 15px; margin-bottom: 10px; }
        .btn-buy { background: var(--main-blue); color: white; border: none; padding: 8px 15px; border-radius: 8px; margin-top: 5px; }
    </style>
</head>
<body>

    <div id="ton-connect"></div>

    <div id="game" class="tab-content active">
        <h2 style="margin-top:40px;">üé£ –¢–ï–†–†–ò–¢–û–†–ò–Ø –õ–û–í–ê</h2>
        <div class="fish-circle" id="catch-btn">
            <span style="font-size: 20px; font-weight: bold;">–ó–ê–ë–†–û–°–ò–¢–¨</span>
        </div>
        <div class="stat-card" id="status-text">–ì–æ—Ç–æ–≤ –∫ —Ä—ã–±–∞–ª–∫–µ</div>
    </div>

    <div id="inventory" class="tab-content">
        <h2>üéí –í–ê–® –°–ê–î–û–ö</h2>
        <div class="stat-card">
            <p>üí∞ –ë–∞–ª–∞–Ω—Å: <span id="user-bal">0.00</span> TC</p>
            <p>üêü –í —Å–∞–¥–∫–µ: <span id="user-fish">0.00</span> –∫–≥</p>
        </div>
        <button class="btn-buy" onclick="sendToBot('sell_fish')">–ü—Ä–æ–¥–∞—Ç—å –≤–µ—Å—å —É–ª–æ–≤ (1–∫–≥ = 0.1 TC)</button>
    </div>

    <div id="shop" class="tab-content">
        <h2>üõí –ú–ê–ì–ê–ó–ò–ù</h2>
        <div class="stat-card">
            <p>üîß –ù–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤</p>
            <p style="font-size:12px; color:#94a3b8;">–ß–∏–Ω–∏—Ç —É–¥–æ—á–∫—É –¥–æ 100%</p>
            <button class="btn-buy" onclick="sendToBot('buy_repair')">–ö—É–ø–∏—Ç—å (10 TC)</button>
        </div>
        <div class="stat-card">
            <p>üçû –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞</p>
            <p style="font-size:12px; color:#94a3b8;">–£–¥–≤–∞–∏–≤–∞–µ—Ç –≤–µ—Å (10 —à—Ç)</p>
            <button class="btn-buy" onclick="sendToBot('buy_bait')">–ö—É–ø–∏—Ç—å (25 TC)</button>
        </div>
    </div>

    <div class="nav-bar">
        <div class="nav-item active-nav" onclick="openTab('game', this)">üé£ –ò–≥—Ä–∞</div>
        <div class="nav-item" onclick="openTab('inventory', this)">üéí –°–∞–¥–æ–∫</div>
        <div class="nav-item" onclick="openTab('shop', this)">üõí –ú–∞–≥–∞–∑–∏–Ω</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.enableClosingConfirmation();

        const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
            manifestUrl: 'https://criptocit-jpg.github.io/tama-fishing/tonconnect-manifest.json',
            buttonRootId: 'ton-connect'
        });

        function openTab(tabId, el) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active-nav'));
            document.getElementById(tabId).classList.add('active');
            el.classList.add('active-nav');
        }

        function sendToBot(actionType) {
            if (!tonConnectUI.connected && actionType === 'catch_fish') {
                alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫!");
                return;
            }
            const data = {
                action: actionType,
                wallet: tonConnectUI.account ? tonConnectUI.account.address : null
            };
            tg.sendData(JSON.stringify(data));
        }

        document.getElementById('catch-btn').addEventListener('click', () => {
            if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');
            sendToBot('catch_fish');
        });
    </script>
</body>
</html>
