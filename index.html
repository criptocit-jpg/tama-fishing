<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Tamacoin Fishing Gold v4.2.1</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --gold: #FFD700; --blue: #0088CC; --bg: #050810; --glass: rgba(255, 255, 255, 0.08); --border: rgba(255, 255, 255, 0.15); }
        body { margin: 0; padding: 0; background: var(--bg); color: white; font-family: -apple-system, sans-serif; overflow: hidden; user-select: none; }
        .top-status { background: #161b22; padding: 12px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border); }
        #u-name { font-weight: 800; font-size: 14px; }
        .rank-tag { background: var(--gold); color: #000; padding: 3px 10px; border-radius: 6px; font-size: 10px; font-weight: 900; text-transform: uppercase; }
        .timer-bar { display: flex; gap: 8px; padding: 10px 15px; background: rgba(0,0,0,0.2); }
        .timer-box { flex: 1; background: var(--glass); border: 1px solid var(--border); border-radius: 12px; padding: 8px; text-align: center; font-size: 11px; }
        .timer-box b { color: var(--gold); display: block; font-size: 13px; }
        .main-balance { text-align: center; padding: 20px 0; }
        .bal-value { font-size: 44px; font-weight: 900; }
        .bal-value span { color: var(--gold); }
        .stats-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; padding: 0 15px; }
        .stat-card { background: var(--glass); border: 1px solid var(--border); border-radius: 18px; padding: 10px; text-align: center; }
        .stat-card small { display: block; font-size: 9px; color: #556080; font-weight: 800; }
        .lake-area { margin: 15px; height: 200px; background: rgba(0,0,0,0.3); border-radius: 30px; border: 1px solid var(--border); position: relative; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .lake-area.sea-active { background: radial-gradient(circle, #001a33 0%, #050810 100%); border-color: var(--blue); }
        #bag-captcha { position: absolute; width: 65px; display: none; filter: drop-shadow(0 0 15px var(--gold)); z-index: 1000; animation: bounce 2s infinite; }
        @keyframes bounce { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-10px)} }
        .page { display: none; height: 100vh; flex-direction: column; overflow-y: auto; padding-bottom: 100px; }
        .page.active { display: flex; }
        .btn { border: none; border-radius: 20px; padding: 16px; font-size: 16px; font-weight: 800; color: white; cursor: pointer; width: 90%; margin: 8px auto; display: block; }
        .btn-blue { background: linear-gradient(180deg, var(--blue), #005580); }
        .btn-gold { background: linear-gradient(180deg, var(--gold), #b8860b); color: #000; }
        .shop-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 15px; }
        .shop-card { background: var(--glass); border: 1px solid var(--border); border-radius: 20px; padding: 12px; text-align: center; }
        .ref-box { background: var(--glass); margin: 15px; padding: 20px; border-radius: 20px; border: 1px dashed var(--gold); text-align: center; }
        #box-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: none; z-index: 5000; flex-direction: column; align-items: center; justify-content: center; }
        .nav-bar { position: fixed; bottom: 0; width: 100%; height: 75px; background: #0a0e17; display: flex; border-top: 1px solid var(--border); padding-bottom: env(safe-area-inset-bottom); }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #444; text-decoration: none; font-size: 10px; }
        .nav-item.active { color: var(--gold); }
    </style>
</head>
<body>
<div id="box-overlay">
    <div id="b-s1" style="text-align:center;"><img src="https://cdn-icons-png.flaticon.com/512/679/679821.png" style="width:150px;animation:shake 0.5s infinite;"></div>
    <div id="b-s2" style="display:none;text-align:center;"><div id="p-v" style="font-size:40px;color:var(--gold);font-weight:900;">+0</div><button class="btn btn-gold" style="width:150px;" onclick="closeBox()">OK</button></div>
</div>
<div id="p-game" class="page active">
    <div class="top-status"><div id="u-n">–†–´–ë–ê–ö</div><div class="rank-tag" id="u-r">–°–ê–õ–ê–ì–ê üå±</div></div>
    <div class="timer-bar"><div class="timer-box">–ó–û–õ–û–¢–û–ô –ß–ê–°<b>19:00</b></div><div class="timer-box">–ë–û–ù–£–°<b>–ì–û–¢–û–í!</b></div></div>
    <div class="main-balance"><div class="bal-value"><span id="v-b">0</span> <span>TC</span></div></div>
    <div class="stats-row">
        <div class="stat-card"><small>–≠–ù–ï–†–ì–ò–Ø</small><b id="v-e">0</b></div>
        <div class="stat-card"><small>–£–î–û–ß–ö–ê</small><b id="v-d">0%</b></div>
        <div class="stat-card"><small>–Ø–©–ò–ö–ò</small><b id="v-x" style="color:var(--gold)">0</b></div>
    </div>
    <div class="lake-area" id="water"><img src="https://cdn-icons-png.flaticon.com/512/2953/2953363.png" id="bag-captcha" onclick="hB()"><div id="g-s" style="color:#333;">...</div></div>
    <button class="btn btn-blue" onclick="ct()">–†–´–ë–ê–ß–ò–¢–¨ üé£</button>
</div>
<div id="p-shop" class="page">
    <div class="shop-grid">
        <div class="shop-card"><b>–ú—è–∫–∏—à</b><button class="btn btn-blue" style="padding:8px;font-size:12px;" onclick="a('buy_tc',{itemId:'bread'})">50</button></div>
        <div class="shop-card"><b>–ú–∞—Å–ª–æ</b><button class="btn btn-blue" style="padding:8px;font-size:12px;" onclick="a('buy_tc',{itemId:'oil'})">150</button></div>
        <div class="shop-card"><b>–†–µ–º–æ–Ω—Ç</b><button class="btn btn-blue" style="padding:8px;font-size:12px;" onclick="a('repair')">50</button></div>
        <div class="shop-card"><b>–ë–∏–ª–µ—Ç –ú–û–†–ï</b><button class="btn btn-gold" style="padding:8px;font-size:12px;" onclick="a('buy_stars',{itemId:'sea_pass'})">‚≠êÔ∏è 250</button></div>
    </div>
</div>
<div id="p-prof" class="page">
    <div class="stat-card" style="margin:15px;"><small>–£–õ–û–í</small><b id="v-f" style="font-size:24px;">0 –∫–≥</b><button class="btn btn-blue" onclick="a('sell_fish')">–ü–†–û–î–ê–¢–¨</button></div>
    <div class="ref-box"><b>–†–ï–§–ï–†–ê–õ–ö–ê 10%</b><br><button class="btn btn-gold" style="padding:10px;font-size:12px;" onclick="c() text-transform:none;">–ö–û–ü–ò–†–û–í–ê–¢–¨</button></div>
    <button class="btn btn-gold" onclick="oB()">–û–¢–ö–†–´–¢–¨ –Ø–©–ò–ö üì¶</button>
    <div style="text-align:center;font-size:10px;color:#333;margin-top:20px;">ID: <span id="v-i"></span></div>
</div>
<nav class="nav-bar">
    <a href="#" class="nav-item active" onclick="g('p-game',this)"><span>üé£</span>–ò–ì–†–ê</a>
    <a href="#" class="nav-item" onclick="g('p-shop',this)"><span>üõí</span>–ú–ê–†–ö–ï–¢</a>
    <a href="#" class="nav-item" onclick="g('p-prof',this)"><span>üë§</span>–ò–ù–§–û</a>
</nav>
<script>
    const tg = window.Telegram.WebApp; const U = 'https://tama-bot-server.onrender.com/api/action'; let u = {};
    tg.ready(); tg.expand();
    function g(p,e){ document.querySelectorAll('.page').forEach(x=>x.classList.remove('active')); document.getElementById(p).classList.add('active'); document.querySelectorAll('.nav-item').forEach(x=>x.classList.remove('active')); e.classList.add('active'); }
    async function a(n,x={}){ const r=await fetch(U,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId:tg.initDataUnsafe?.user?.id||"7883085758",userName:tg.initDataUnsafe?.user?.first_name||"–†—ã–±–∞–∫",action:n,...x})}); u=await r.json(); d(); }
    function d(){
        document.getElementById('v-b').innerText=Math.floor(u.b); document.getElementById('v-e').innerText=Math.floor(u.energy);
        document.getElementById('v-d').innerText=u.durability+'%'; document.getElementById('v-x').innerText=u.boxes;
        document.getElementById('v-f').innerText=(u.fish||0).toFixed(2)+' –∫–≥'; document.getElementById('u-r').innerText=u.level||"–°–ê–õ–ê–ì–ê üå±";
        document.getElementById('u-n').innerText=(u.n||"–†—ã–±–∞–∫").toUpperCase(); document.getElementById('v-i').innerText=u.id;
        if(u.location==='sea')document.getElementById('water').classList.add('sea-active'); else document.getElementById('water').classList.remove('sea-active');
        if(u.msg)tg.showAlert(u.msg);
    }
    function ct(){ if((u.castCount+1)%5===0){ const b=document.getElementById('bag-captcha'); b.style.display='block'; b.style.left=Math.random()*70+'%'; b.style.top=Math.random()*60+'%'; } else a('catch_fish'); }
    function hB(){ document.getElementById('bag-captcha').style.display='none'; a('catch_fish',{captchaPassed:true}); }
    async function oB(){ if(u.boxes<=0)return tg.showAlert("–ù–ï–¢ –Ø–©–ò–ö–û–í!"); document.getElementById('box-overlay').style.display='flex'; const r=await fetch(U,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId:u.id,action:'open_box'})}); const d=await r.json(); setTimeout(()=>{ document.getElementById('b-s1').style.display='none'; document.getElementById('b-s2').style.display='block'; document.getElementById('p-v').innerText='+'+d.prize+' TC'; },1500); }
    function closeBox(){ document.getElementById('box-overlay').style.display='none'; document.getElementById('b-s1').style.display='block'; document.getElementById('b-s2').style.display='none'; a('load'); }
    function c(){ const l=`https://t.me/Tamacoin_bot?start=${u.id}`; const i=document.createElement("input"); document.body.appendChild(i); i.value=l; i.select(); document.execCommand("copy"); document.body.removeChild(i); tg.showAlert("OK!"); }
    setInterval(()=>a('load'),20000); a('load');
</script>
<style>@keyframes shake{0%,100%{transform:rotate(0)}20%{transform:rotate(8deg)}80%{transform:rotate(-8deg)}}</style>
</body>
</html>
