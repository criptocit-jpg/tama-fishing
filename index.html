<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>Tamacoin Fishing Gold 6.5</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
:root { --gold: #FFD700; --dark: #0a0e1a; --wood: #5d4037; --glass: rgba(255,255,255,0.07); }
body { margin:0; background:var(--dark); color:white; font-family:'Segoe UI',sans-serif; overflow:hidden; height:100vh; }
.page { display:none; height:100vh; padding:15px; box-sizing:border-box; flex-direction:column; padding-bottom:110px; }
.page.active { display:flex; }
#wood-plate{position:fixed;top:40%;left:50%;transform:translate(-50%,-50%) scale(0);background:var(--wood);border:3px solid #3e2723;border-radius:12px;padding:15px;text-align:center;width:75%;z-index:2000;box-shadow:0 10px 30px rgba(0,0,0,0.8);transition:0.4s cubic-bezier(0.175,0.885,0.32,1.275);}
#wood-plate.show{transform:translate(-50%,-50%) scale(1);}
.acc-item{background:var(--glass);border-radius:12px;margin-bottom:8px;border:1px solid rgba(255,255,255,0.1);overflow:hidden;}
.acc-head{padding:15px;cursor:pointer;display:flex;justify-content:space-between;font-weight:bold;background:rgba(255,255,255,0.02);}
.acc-body{display:none;padding:10px;grid-template-columns:1fr 1fr;gap:8px;border-top:1px solid rgba(255,255,255,0.1);}
.acc-item.open .acc-body{display:grid;}
.top-row{display:flex;justify-content:space-between;font-size:11px;color:var(--gold);margin-bottom:10px;font-family:monospace;}
.lake-zone{flex-grow:1;position:relative;background:radial-gradient(circle,#1a2a44 0%,#0a0e1a 100%);border-radius:20px;display:flex;align-items:center;justify-content:center;margin-bottom:10px;border:1px solid rgba(0,136,204,0.3);overflow:hidden;}
.lake-zone.active{box-shadow:inset 0 0 50px rgba(0,136,204,0.5);border-color:var(--gold);}
#fish-anim{width:100%;height:100%;object-fit:contain;display:none;animation:fish-big-pulse 0.8s infinite alternate ease-in-out;}
@keyframes fish-big-pulse{from{transform:scale(0.95);}to{transform:scale(1.05);}}
.btn-cast{width:100%;padding:22px;background:var(--gold);border:none;border-radius:20px;font-weight:900;font-size:20px;color:#000;}
.btn-daily{background:#2e7d32;color:white;border:none;padding:12px;border-radius:12px;width:100%;margin-bottom:10px;font-weight:bold;display:none;}
nav{position:fixed;bottom:0;width:100%;height:75px;background:#0d121f;display:flex;border-top:1px solid rgba(255,255,255,0.1);z-index:1000;}
.nav-item{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:10px;color:#5a6275;text-decoration:none;}
.nav-item.active{color:var(--gold);}
.stat-mini{background:var(--glass);padding:8px;border-radius:8px;text-align:center;font-size:11px;flex:1;}
.shop-btn{background:#2e7d32;color:white;border:none;padding:6px;border-radius:6px;width:100%;margin-top:5px;font-weight:bold;}
.toast{position:fixed;top:20px;left:50%;transform:translateX(-50%);background:var(--gold);color:#000;padding:10px 20px;border-radius:20px;display:none;z-index:3000;font-weight:bold;}
input{width:100%;padding:12px;margin-bottom:8px;background:rgba(0,0,0,0.4);border:1px solid #333;color:#fff;border-radius:8px;box-sizing:border-box;}
#ticker{position:fixed;top:0;width:100%;overflow:hidden;white-space:nowrap;background:#222;color:var(--gold);padding:5px 0;font-weight:bold;z-index:3001;text-align:center;}

/* —Ç–∞–π–º–µ—Ä—ã */
.top-timers{display:flex;justify-content:center;gap:15px;margin-top:35px;}
.timer-box{background:rgba(255,255,255,0.07);padding:8px 12px;border-radius:12px;font-weight:bold;color:white;min-width:130px;text-align:center;}

/* —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π TC */
.center-score{text-align:center;margin:15px 0;}
#u-b{font-size:42px;font-weight:900;color:var(--gold);transition:all 0.5s ease;}
.score-label{font-size:12px;color:white;margin-top:2px;opacity:0.7;}

/* —Å—Ç–∞—Ç—ã */
.stats-row{display:flex;justify-content:center;gap:10px;margin-bottom:15px;}
.stat-mini{background:var(--glass);padding:8px 12px;border-radius:8px;text-align:center;font-size:12px;flex:1;min-width:60px;}

/* –∞–Ω–∏–º–∞—Ü–∏—è —Ü–∏—Ñ—Ä */
.scroll-num{display:inline-block; transition: all 0.5s ease;}
</style>
</head>
<body>

<div id="ticker"></div>

<div class="top-timers">
    <div id="t-gold" class="timer-box scroll-num">–ó–û–õ–û–¢–û–ô –ß–ê–°: --:--:--</div>
    <div id="t-daily" class="timer-box scroll-num">–ë–û–ù–£–°: --:--:--</div>
</div>

<div class="center-score">
    <div id="u-b" class="scroll-num">0</div>
    <div class="score-label">TAMACON</div>
</div>

<div class="stats-row">
    <div class="stat-mini">‚ö° <span id="u-en" class="scroll-num">0</span></div>
    <div class="stat-mini">üõ†Ô∏è <span id="u-dur" class="scroll-num">0%</span></div>
    <div class="stat-mini">üì¶ <span id="u-box" class="scroll-num">0</span></div>
</div>

<div id="ocean" class="lake-zone"><img src="fish_anim.webp" id="fish-anim"></div>
<div style="margin-top:auto;">
<button id="btn-daily" class="btn-daily" onclick="api('get_daily')">üéÅ –ó–ê–ë–†–ê–¢–¨ –ë–û–ù–£–°</button>
<button id="btn-cast" class="btn-cast" onclick="doCast()">–ó–ê–ë–†–û–°–ò–¢–¨ üé£</button>
</div>
</div>

<!-- –°–∞–¥–æ–∫ –∏ –º–∞–≥–∞–∑–∏–Ω -->
<div id="p-sadok" class="page">
<div class="acc-item open">
<div class="acc-head">üêü –°–ê–î–û–ö</div>
<div class="acc-body" style="display:flex; justify-content:space-between; grid-template-columns:none; align-items:center;">
<span>–í–µ—Å: <b id="u-fish" class="scroll-num">0</b> –∫–≥</span>
<button onclick="api('sell')" style="background:var(--gold); border:none; padding:10px 20px; border-radius:8px; font-weight:bold;">–ü–†–û–î–ê–¢–¨</button>
</div>
</div>

<div class="acc-item">
<div class="acc-head" onclick="toggleAcc(this)">üõí –ú–ê–ì–ê–ó–ò–ù TC <span>‚ñº</span></div>
<div class="acc-body">
<div class="stat-mini">–ú—è–∫–∏—à (100)<button class="shop-btn" onclick="api('buy',{id:'myakish'})">–ö–£–ü–ò–¢–¨</button></div>
<div class="stat-mini">–°–Ω–∞—Å—Ç–∏ (200)<button class="shop-btn" onclick="api('buy',{id:'gear'})">–ö–£–ü–ò–¢–¨</button></div>
<div class="stat-mini">–≠–Ω–µ—Ä–≥–∏—è (50)<button class="shop-btn" onclick="api('buy',{id:'energy'})">–ö–£–ü–ò–¢–¨</button></div>
<div class="stat-mini">–†–µ–º–æ–Ω—Ç (50)<button class="shop-btn" onclick="api('buy',{id:'repair'})">–ö–£–ü–ò–¢–¨</button></div>
</div>
</div>

<div class="acc-item">
<div class="acc-head" onclick="toggleAcc(this)" style="color:var(--gold)">üíé VIP STARS <span>‚ñº</span></div>
<div class="acc-body">
<div class="stat-mini">–¢–∏—Ç–∞–Ω (150)<button class="shop-btn" onclick="api('buy',{id:'titan'})">–ö–£–ü–ò–¢–¨</button></div>
<div class="stat-mini">–ü—Ä–∏–∫–æ—Ä–º (200)<button class="shop-btn" onclick="api('buy',{id:'bait'})">–ö–£–ü–ò–¢–¨</button></div>
<div class="stat-mini">–°–Ω–∞—Å—Ç–∏+ (200)<button class="shop-btn" onclick="api('buy',{id:'strong'})">–ö–£–ü–ò–¢–¨</button></div>
<div class="stat-mini">–û–∑–µ—Ä–æ –ù–∞–¥–µ–∂–¥—ã (500)<button class="shop-btn" onclick="api('buy',{id:'license'})">–ö–£–ü–ò–¢–¨</button></div>
</div>
</div>

<div class="acc-item">
<div class="acc-head" onclick="toggleAcc(this)">üí≥ –í–´–í–û–î <span>‚ñº</span></div>
<div class="acc-body" style="grid-template-columns:1fr;">
<input id="w-wallet" placeholder="TON –ö–æ—à–µ–ª–µ–∫">
<input id="w-sum" type="number" placeholder="–°—É–º–º–∞ TC">
<button onclick="withdraw()" style="background:#0088cc;color:white;border:none;padding:12px;border-radius:10px;width:100%;font-weight:bold;">–í–´–í–ï–°–¢–ò</button>
</div>
</div>
</div>

<div id="p-top" class="page"><h2 style="text-align:center;color:var(--gold);">üèÜ –¢–û–ü</h2><div id="top-list"></div></div>

<div id="p-info" class="page">
<h2 style="color:var(--gold);">–ò–ù–§–û</h2>
<div id="ref-link" style="background:rgba(255,255,255,0.05); padding:12px; border-radius:10px; word-break:break-all; font-size:11px; color:var(--gold); display:flex; justify-content:space-between; align-items:center;">
<span id="ref-text">–í–∞—à–∞ —Å—Å—ã–ª–∫–∞: </span>
<button onclick="copyRef()" style="background:var(--gold); color:#000; border:none; padding:4px 8px; border-radius:6px; font-weight:bold;">–°–ö–û–ü–ò–†–û–í–ê–¢–¨</button>
</div>
<div style="margin-top:10px; font-size:12px; line-height:1.4; opacity:0.8;">
–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Tamacoin Fishing! –ó–¥–µ—Å—å –≤—ã –ª–æ–≤–∏—Ç–µ —Ä—ã–±—É, –ø—Ä–æ–¥–∞—ë—Ç–µ –µ—ë –∑–∞ TC, —É—á–∞—Å—Ç–≤—É–µ—Ç–µ –≤ —Ä–µ–¥–∫–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö –∏ –ø–æ–ª—É—á–∞–µ—Ç–µ –±–æ–Ω—É—Å—ã.  
–í—Å–µ –≤–∞—à–∏ –¥–µ–π—Å—Ç–≤–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∏ –≤–∏–¥–Ω—ã –≤ —Ç–æ–ø–µ –∏–≥—Ä–æ–∫–æ–≤.  
–ë–æ–Ω—É—Å—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ä–∞–∑ –≤ –¥–µ–Ω—å, –∞ –∑–æ–ª–æ—Ç–æ–π —á–∞—Å –∞–∫—Ç–∏–≤–µ–Ω –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 19:00.
</div>
</div>

<nav>
<a href="javascript:void(0)" class="nav-item active" onclick="showP('p-game',this)"><i>üéÆ</i>–ò–ì–†–ê</a>
<a href="javascript:void(0)" class="nav-item" onclick="showP('p-sadok',this)"><i>üéí</i>–°–ê–î–û–ö</a>
<a href="javascript:void(0)" class="nav-item" onclick="showP('p-top',this)"><i>üèÜ</i>–¢–û–ü</a>
<a href="javascript:void(0)" class="nav-item" onclick="showP('p-info',this)"><i>‚ÑπÔ∏è</i>–ò–ù–§–û</a>
</nav>

<div id="toast" class="toast"></div>

<script>
const tg=window.Telegram.WebApp;
tg.ready(); tg.expand();
const URL='https://tama-bot-server.onrender.com/api/action';
let user={lastBonus:0};

function showP(id,el){
    document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    document.querySelectorAll('.nav-item').forEach(b=>b.classList.remove('active'));
    el.classList.add('active');
}
function toggleAcc(el){ el.parentElement.classList.toggle('open'); }
function toast(txt){
    const t=document.getElementById('toast'); t.innerText=txt; t.style.display='block';
    setTimeout(()=>t.style.display='none',2500);
}

function copyRef(){
    const text=document.getElementById('ref-text').innerText+"https://t.me/TamacoinBot?start="+user.id;
    navigator.clipboard.writeText(text);
    toast("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!");
}

// —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ —á–∏—Å–µ–ª
function animateNumber(el, newVal, duration=500){
    const startVal = parseFloat(el.innerText.replace(/[^\d.]/g,'')) || 0;
    const diff = newVal - startVal;
    const startTime = performance.now();

    function step(currentTime){
        const progress = Math.min((currentTime - startTime)/duration, 1);
        const value = startVal + diff * progress;
        if(el.id==='u-dur') el.innerText = Math.floor(value)+'%';
        else if(el.classList.contains('scroll-num')) el.innerText = Math.floor(value).toLocaleString();
        if(progress<1) requestAnimationFrame(step);
    }
    requestAnimationFrame(step);
}

async function api(action,payload={}){
    try{
        const uid=tg.initDataUnsafe?.user?.id||"7883085758";
        const uname=tg.initDataUnsafe?.user?.first_name||"–†—ã–±–∞–∫";
        const r=await fetch(URL,{
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify({userId:uid,userName:uname,action,payload})
        });
        const d=await r.json();
        if(d.msg) toast(d.msg);
        render(d);
        if(d.events) updateTicker(d.events);
        if(d.catchData){
            document.getElementById('catch-res').innerHTML=d.catchData.type+'<br>'+d.catchData.w+' –∫–≥';
            document.getElementById('wood-plate').classList.add('show');
        }
    }catch(e){ console.error(e); }
}

function render(d){
    if(!d||!d.id) return;
    user=d;
    animateNumber(document.getElementById('u-b'), d.b);
    animateNumber(document.getElementById('u-fish'), (d.fish||0).toFixed(2));
    animateNumber(document.getElementById('u-en'), d.energy||0);
    animateNumber(document.getElementById('u-dur'), Math.max(0,d.dur||0));
    animateNumber(document.getElementById('u-box'), d.boxes||0);
    document.getElementById('ref-text').innerText="–í–∞—à–∞ —Å—Å—ã–ª–∫–∞: https://t.me/TamacoinBot?start="+d.id;

    if(d.top){
        document.getElementById('top-list').innerHTML=d.top.map((x,i)=>
            `<div class="stat-mini" style="margin-bottom:5px; display:flex; justify-content:space-between;">
            <span>${i+1}. ${x.n}</span><b>${Math.floor(x.b).toLocaleString()} TC</b></div>`
        ).join('');
    }
}

function doCast(){
    const f=document.getElementById('fish-anim');
    const b=document.getElementById('btn-cast');
    const o=document.getElementById('ocean');
    f.style.display='block'; b.disabled=true; o.classList.add('active');
    setTimeout(()=>{
        f.style.display='none'; b.disabled=false; o.classList.remove('active');
        api('cast');
    },1300);
}

function withdraw(){
    const wallet=document.getElementById('w-wallet').value;
    const sum=parseInt(document.getElementById('w-sum').value);
    if(!wallet||!sum) return toast("–ó–∞–ø–æ–ª–Ω–∏ –ø–æ–ª—è!");
    if(sum<30000) return toast("–í—ã–≤–æ–¥ –≤–æ–∑–º–æ–∂–µ–Ω —Ç–æ–ª—å–∫–æ –æ—Ç 30 000 TC!");
    api('withdraw',{wallet,sum});
}

setInterval(()=>{
    const now=new Date();
    let target=new Date(); target.setHours(19,0,0,0);
    if(now>target) target.setDate(target.getDate()+1);
    let diff=target-now;
    const h=String(Math.floor(diff/3600000)).padStart(2,'0');
    const m=String(Math.floor((diff%3600000)/60000)).padStart(2,'0');
    const s=String(Math.floor((diff%60000)/1000)).padStart(2,'0');
    document.getElementById('t-gold').innerText=(now.getHours()===19)?"–ê–ö–¢–ò–í–ï–ù! üî•":h+":"+m+":"+s;

    let bDiff=(user.lastBonus+86400000)-Date.now();
    if(bDiff>0){
        const bh=String(Math.floor(bDiff/3600000)).padStart(2,'0');
        const bm=String(Math.floor((bDiff%3600000)/60000)).padStart(2,'0');
        const bs=String(Math.floor((bDiff%60000)/1000)).padStart(2,'0');
        document.getElementById('t-daily').innerText=bh+":"+bm+":"+bs;
        document.getElementById('btn-daily').style.display='none';
    }else{
        document.getElementById('t-daily').innerText="–ì–û–¢–û–í–û!";
        document.getElementById('btn-daily').style.display='block';
    }
},1000);

function updateTicker(events){
    const ticker=document.getElementById('ticker');
    if(!events||!events.length) return;
    ticker.innerHTML=events.join(' | ');
    ticker.style.animation='none';
    void ticker.offsetWidth;
    ticker.style.animation='scroll 20s linear infinite';
}

const style=document.createElement('style');
style.innerHTML=`@keyframes scroll {0%{transform:translateX(100%);}100%{transform:translateX(-100%);}}`;
document.head.appendChild(style);

</script>
</body>
</html>
