<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Tamacoin Fishing Gold v4.2.3</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* ==========================================
           –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò –ò –ü–ï–†–ï–ú–ï–ù–ù–´–ï
           ========================================== */
        :root {
            --gold: #FFD700;
            --gold-dark: #B8860B;
            --blue: #0088CC;
            --blue-dark: #005580;
            --bg: #050810;
            --glass: rgba(255, 255, 255, 0.08);
            --border: rgba(255, 255, 255, 0.15);
        }

        body {
            margin: 0; padding: 0; background: var(--bg); color: white;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            overflow: hidden; user-select: none; -webkit-tap-highlight-color: transparent;
        }

        /* –®–ê–ü–ö–ê –ò –°–¢–ê–¢–£–° */
        .header {
            background: linear-gradient(180deg, #161b22 0%, #050810 100%);
            padding: 15px 20px; display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid var(--border);
        }

        .user-name { font-weight: 800; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; }
        .rank-tag {
            background: var(--gold); color: #000; padding: 2px 8px;
            border-radius: 4px; font-size: 10px; font-weight: 900; margin-top: 4px;
            display: inline-block; box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
        }

        /* –ë–ê–õ–ê–ù–° */
        .balance-container { text-align: center; padding: 25px 0; }
        .balance-label { font-size: 10px; color: #556080; letter-spacing: 2px; font-weight: 800; }
        .balance-value { font-size: 48px; font-weight: 900; margin-top: 5px; }
        .balance-value span { color: var(--gold); }

        /* –ü–ê–ù–ï–õ–¨ –°–¢–ê–¢–ò–°–¢–ò–ö–ò */
        .stats-grid {
            display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; padding: 0 15px;
        }

        .stat-card {
            background: var(--glass); border: 1px solid var(--border);
            padding: 15px 5px; border-radius: 20px; text-align: center;
        }

        .stat-card small { display: block; font-size: 9px; color: #556080; font-weight: 800; margin-bottom: 5px; }
        .stat-card b { font-size: 17px; font-weight: 800; }

        /* –ò–ì–†–û–í–ê–Ø –ó–û–ù–ê (–û–ó–ï–†–û/–ú–û–†–ï) */
        .lake-area {
            margin: 15px; height: 210px; background: rgba(0,0,0,0.4);
            border-radius: 35px; border: 1px solid var(--border);
            position: relative; display: flex; align-items: center; justify-content: center;
            overflow: hidden; transition: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .lake-area.sea-mode {
            background: radial-gradient(circle, #001a33 0%, #050810 100%);
            border-color: var(--blue); box-shadow: inset 0 0 40px rgba(0, 136, 204, 0.3);
        }

        #splash-effect {
            position: absolute; width: 100%; height: 100%;
            background: radial-gradient(circle, rgba(0,136,204,0.3) 0%, transparent 70%);
            display: none; pointer-events: none; z-index: 10;
        }

        #bag-captcha {
            position: absolute; width: 75px; display: none;
            filter: drop-shadow(0 0 20px var(--gold)); cursor: pointer; z-index: 100;
            animation: bounce 2s infinite ease-in-out;
        }

        @keyframes bounce { 0%,100%{transform:translateY(0) scale(1)} 50%{transform:translateY(-15px) scale(1.1)} }

        .status-msg {
            position: absolute; bottom: 15px; font-size: 11px; font-weight: 800;
            color: rgba(255,255,255,0.3); text-transform: uppercase;
        }

        /* –ö–ù–û–ü–ö–ò */
        .btn {
            width: 90%; margin: 10px auto; border: none; border-radius: 22px;
            padding: 18px; font-size: 17px; font-weight: 900; color: white;
            cursor: pointer; transition: 0.2s; text-transform: uppercase; display: block;
        }

        .btn-blue { background: linear-gradient(180deg, var(--blue), var(--blue-dark)); box-shadow: 0 5px 15px rgba(0, 136, 204, 0.3); }
        .btn-gold { background: linear-gradient(180deg, var(--gold), var(--gold-dark)); color: black; box-shadow: 0 5px 15px rgba(255, 215, 0, 0.2); }
        .btn:active { transform: scale(0.96); opacity: 0.9; }
        .btn:disabled { background: #333; color: #666; box-shadow: none; cursor: not-allowed; }

        /* –°–¢–†–ê–ù–ò–¶–´ */
        .page { display: none; height: 100vh; flex-direction: column; overflow-y: auto; padding-bottom: 110px; box-sizing: border-box; }
        .page.active { display: flex; }

        /* –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –Ø–©–ò–ö–ê */
        #box-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.96); display: none; z-index: 9999;
            flex-direction: column; align-items: center; justify-content: center;
            backdrop-filter: blur(8px);
        }

        .box-anim { width: 170px; filter: drop-shadow(0 0 30px var(--gold)); animation: shake 0.5s infinite; }
        @keyframes shake { 0%,100%{transform:rotate(0)} 25%{transform:rotate(8deg)} 75%{transform:rotate(-8deg)} }

        .prize-win { text-align: center; display: none; animation: pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes pop { 0% {transform: scale(0.5); opacity: 0;} 100% {transform: scale(1); opacity: 1;} }

        /* –ú–ê–ì–ê–ó–ò–ù –ò –ò–ù–§–û */
        .shop-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 15px; }
        .shop-card { background: var(--glass); border: 1px solid var(--border); border-radius: 25px; padding: 15px; text-align: center; }
        .shop-card b { display: block; margin-bottom: 5px; font-size: 15px; }
        .shop-card small { display: block; font-size: 11px; color: #556080; min-height: 32px; margin-bottom: 10px; }

        .info-box { background: var(--glass); margin: 15px; padding: 20px; border-radius: 25px; border: 1px solid var(--border); }
        .info-box h3 { margin: 0 0 10px 0; color: var(--gold); font-size: 16px; }
        .info-box p { margin: 0; font-size: 13px; line-height: 1.5; color: #cdd6f4; }

        /* –ù–ê–í–ò–ì–ê–¶–ò–Ø */
        .nav-bar {
            position: fixed; bottom: 0; width: 100%; height: 85px;
            background: rgba(10, 14, 23, 0.98); display: flex; border-top: 1px solid var(--border);
            padding-bottom: env(safe-area-inset-bottom);
        }

        .nav-item {
            flex: 1; display: flex; flex-direction: column; align-items: center;
            justify-content: center; color: #444; text-decoration: none; transition: 0.3s;
        }

        .nav-item.active { color: var(--gold); }
        .nav-item span { font-size: 22px; margin-bottom: 4px; }
        .nav-item label { font-size: 10px; font-weight: 800; text-transform: uppercase; }

    </style>
</head>
<body>

    <div id="box-overlay">
        <div id="box-stage-shake" style="text-align:center;">
            <img src="https://cdn-icons-png.flaticon.com/512/679/679821.png" class="box-anim">
            <h2 style="color:var(--gold); margin-top:25px; letter-spacing:2px;">–†–ê–°–ü–ê–ö–û–í–ö–ê...</h2>
        </div>
        <div id="box-stage-prize" class="prize-win">
            <div id="prize-amount-text" style="font-size: 60px; font-weight: 900; color: var(--gold);">+500 TC</div>
            <p style="color: #8892b0; margin-bottom: 30px;">–°–£–ú–ú–ê –î–û–ë–ê–í–õ–ï–ù–ê –ö –ë–ê–õ–ê–ù–°–£</p>
            <button class="btn btn-gold" style="width: 200px;" onclick="closeBoxUI()">–û–¢–õ–ò–ß–ù–û</button>
        </div>
    </div>

    <div id="p-game" class="page active">
        <div class="header">
            <div>
                <div class="user-name" id="ui-name">–ó–ê–ì–†–£–ó–ö–ê...</div>
                <div class="rank-badge" id="ui-rank">–°–ê–õ–ê–ì–ê üå±</div>
            </div>
            <div style="text-align:right">
                <small style="color:#556080; font-weight:800;">ID:</small>
                <span id="ui-id" style="font-size:10px; color:var(--gold)">---</span>
            </div>
        </div>

        <div class="balance-container">
            <div class="balance-label">–î–û–°–¢–£–ü–ù–û –î–õ–Ø –í–´–í–û–î–ê</div>
            <div class="balance-value"><span id="ui-bal">0</span> <span>TC</span></div>
        </div>

        <div class="stats-grid">
            <div class="stat-card"><small>–≠–ù–ï–†–ì–ò–Ø</small><b id="ui-energy">0</b></div>
            <div class="stat-card"><small>–£–î–û–ß–ö–ê</small><b id="ui-dur">0%</b></div>
            <div class="stat-card"><small>–Ø–©–ò–ö–ò</small><b id="ui-box" style="color:var(--gold)">0</b></div>
        </div>

        <div class="lake-area" id="water-zone">
            <div id="splash-effect"></div>
            <img src="https://cdn-icons-png.flaticon.com/512/2953/2953363.png" id="bag-captcha" onclick="onCaptchaClaim()">
            <div class="status-msg" id="ui-status">–û–ñ–ò–î–ê–ù–ò–ï –ó–ê–ë–†–û–°–ê</div>
        </div>

        <button class="btn btn-blue" id="main-cast-btn" onclick="performCast()">–ó–ê–ë–†–û–°–ò–¢–¨ –£–î–û–ß–ö–£ üé£</button>
        <button class="btn btn-gold" onclick="apiCall('get_daily')">–ó–ê–ë–†–ê–¢–¨ –ë–û–ù–£–° üéÅ</button>
    </div>

    <div id="p-shop" class="page">
        <h2 style="padding: 15px 20px; margin:0">–ú–ê–ì–ê–ó–ò–ù</h2>
        <div class="shop-grid">
            <div class="shop-card">
                <b>–•–ª–µ–±</b><small>+5 —É–¥–∞—á–Ω—ã—Ö –∑–∞–±—Ä–æ—Å–æ–≤</small>
                <button class="btn btn-blue" style="padding:10px; font-size:12px; margin:0" onclick="apiCall('buy_tc',{itemId:'bread'})">50 TC</button>
            </div>
            <div class="shop-card">
                <b>–ú–∞—Å–ª–æ</b><small>-50% –∏–∑–Ω–æ—Å–∞ —Å–Ω–∞—Å—Ç–∏</small>
                <button class="btn btn-blue" style="padding:10px; font-size:12px; margin:0" onclick="apiCall('buy_tc',{itemId:'oil'})">150 TC</button>
            </div>
            <div class="shop-card">
                <b>–†–µ–º–æ–Ω—Ç</b><small>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ 100%</small>
                <button class="btn btn-blue" style="padding:10px; font-size:12px; margin:0" onclick="apiCall('repair')">50 TC</button>
            </div>
            <div class="shop-card" style="border-color:var(--gold)">
                <b>–ë–∏–ª–µ—Ç –ú–æ—Ä–µ</b><small>–î–æ—Å—Ç—É–ø –∫ –∫—Ä—É–ø–Ω–æ–π —Ä—ã–±–µ</small>
                <button class="btn btn-gold" style="padding:10px; font-size:12px; margin:0" onclick="apiCall('buy_stars',{itemId:'sea_pass'})">‚≠êÔ∏è 250</button>
            </div>
        </div>
    </div>

    <div id="p-prof" class="page">
        <h2 style="padding: 15px 20px; margin:0">–ü–†–û–§–ò–õ–¨</h2>
        <div class="info-box" style="text-align:center; padding: 30px 15px;">
            <small style="color:#556080; font-weight:800;">–†–´–ë–ê –í –ò–ù–í–ï–ù–¢–ê–†–ï</small>
            <div style="font-size:36px; font-weight:900; margin:15px 0;" id="ui-fish-weight">0.00 –ö–ì</div>
            <button class="btn btn-blue" style="width:100%; margin:0" onclick="apiCall('sell_fish')">–ü–†–û–î–ê–¢–¨ –í–°–Æ –†–´–ë–£</button>
        </div>

        <button class="btn btn-gold" onclick="openBoxSequence()">–û–¢–ö–†–´–¢–¨ –î–û–ë–´–¢–´–ô –Ø–©–ò–ö üì¶</button>

        <div class="info-box">
            <h3>–†–ï–§–ï–†–ê–õ–¨–ù–ê–Ø –ü–†–û–ì–†–ê–ú–ú–ê</h3>
            <p>–ü—Ä–∏–≥–ª–∞—à–∞–π –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∞–π 10% –æ—Ç –∏—Ö –∑–∞—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –±–∞–ª–∞–Ω—Å!</p>
            <button class="btn btn-gold" style="font-size:13px; padding:15px; margin-top:15px" onclick="copyReferral()">–ö–û–ü–ò–†–û–í–ê–¢–¨ –°–°–´–õ–ö–£</button>
        </div>
    </div>

    <div id="p-info" class="page">
        <h2 style="padding: 15px 20px; margin:0">–ò–ù–§–û</h2>
        <div class="info-box">
            <h3>–û –ø—Ä–æ–µ–∫—Ç–µ</h3>
            <p>Tamacoin Fishing ‚Äî —ç—Ç–æ —Å–∏–º—É–ª—è—Ç–æ—Ä —Ä—ã–±–∞–ª–∫–∏ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∑–∞—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤. –£–ª—É—á—à–∞–π—Ç–µ —Å–Ω–∞—Å—Ç–∏, –æ—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –Ω–æ–≤—ã–µ –ª–æ–∫–∞—Ü–∏–∏ –∏ —Å—Ç–∞–Ω—å—Ç–µ –í–ª–∞–¥—ã–∫–æ–π –û–∫–µ–∞–Ω–∞!</p>
        </div>
        <div class="info-box">
            <h3>–ü–æ–º–æ—â—å</h3>
            <p>‚Ä¢ –≠–Ω–µ—Ä–≥–∏—è –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å–∞–º–∞: 0.5 –µ–¥/–º–∏–Ω.<br>‚Ä¢ –£–¥–æ—á–∫–∞ –ª–æ–º–∞–µ—Ç—Å—è ‚Äî –Ω–µ –∑–∞–±—ã–≤–∞–π —á–∏–Ω–∏—Ç—å –≤ –º–∞—Ä–∫–µ—Ç–µ.<br>‚Ä¢ –ö–∞–∂–¥—ã–µ 5 –∑–∞–±—Ä–æ—Å–æ–≤ –ª–æ–≤–∏ –º–µ—à–æ—á–µ–∫, —á—Ç–æ–±—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å, —á—Ç–æ —Ç—ã –Ω–µ –±–æ—Ç.</p>
        </div>
        <div style="text-align:center; padding:20px; color:#333; font-size:11px; font-weight:800;">
            BUILD 4.2.3 STABLE | MONOLITH
        </div>
    </div>

    <nav class="nav-bar">
        <a href="#" class="nav-item active" onclick="changeTab('p-game', this)"><span>üé£</span><label>–ò–≥—Ä–∞</label></a>
        <a href="#" class="nav-item" onclick="changeTab('p-shop', this)"><span>üõí</span><label>–ú–∞—Ä–∫–µ—Ç</label></a>
        <a href="#" class="nav-item" onclick="changeTab('p-prof', this)"><span>üë§</span><label>–ü—Ä–æ—Ñ–∏–ª—å</label></a>
        <a href="#" class="nav-item" onclick="changeTab('p-info', this)"><span>‚ÑπÔ∏è</span><label>–ò–Ω—Ñ–æ</label></a>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        const API_URL = 'https://tama-bot-server.onrender.com/api/action';
        let userData = {};

        tg.ready();
        tg.expand();

        function changeTab(pageId, el) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            el.classList.add('active');
            tg.HapticFeedback.impactOccurred('light');
        }

        async function apiCall(action, params = {}) {
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        userId: tg.initDataUnsafe?.user?.id || "7883085758",
                        userName: tg.initDataUnsafe?.user?.first_name || "–†—ã–±–∞–∫",
                        action: action, ...params
                    })
                });
                const data = await response.json();
                userData = data;
                updateUI();
                if (data.msg && action !== 'load') tg.showAlert(data.msg);
                return data;
            } catch (e) { console.error("API Error:", e); }
        }

        function updateUI() {
            document.getElementById('ui-bal').innerText = Math.floor(userData.b).toLocaleString();
            document.getElementById('ui-energy').innerText = Math.floor(userData.energy);
            document.getElementById('ui-dur').innerText = Math.floor(userData.durability) + '%';
            document.getElementById('ui-box').innerText = userData.boxes;
            document.getElementById('ui-fish-weight').innerText = (userData.fish || 0).toFixed(2) + ' –ö–ì';
            document.getElementById('ui-name').innerText = (userData.n || "–†—ã–±–∞–∫").toUpperCase();
            document.getElementById('ui-rank').innerText = userData.level || "–°–ê–õ–ê–ì–ê üå±";
            document.getElementById('ui-id').innerText = userData.id;

            const water = document.getElementById('water-zone');
            if (userData.location === 'sea') water.classList.add('sea-mode');
            else water.classList.remove('sea-mode');
        }

        function performCast() {
            const btn = document.getElementById('main-cast-btn');
            const splash = document.getElementById('splash-effect');
            const status = document.getElementById('ui-status');

            // –ê–ù–ò–ú–ê–¶–ò–Ø –ó–ê–ë–†–û–°–ê (–í–û–ó–í–†–ê–©–ï–ù–ê)
            btn.disabled = true;
            status.innerText = "–ó–ê–ë–†–û–° –°–ù–ê–°–¢–ò...";
            splash.style.display = 'block';
            tg.HapticFeedback.impactOccurred('medium');

            setTimeout(() => {
                splash.style.display = 'none';
                btn.disabled = false;
                status.innerText = "–ì–û–¢–û–í –ö –ó–ê–ë–†–û–°–£";

                if ((userData.castCount + 1) % 5 === 0) {
                    const bag = document.getElementById('bag-captcha');
                    bag.style.display = 'block';
                    bag.style.left = (Math.random() * 60 + 10) + '%';
                    bag.style.top = (Math.random() * 40 + 10) + '%';
                    tg.HapticFeedback.notificationOccurred('warning');
                } else {
                    apiCall('catch_fish');
                }
            }, 800);
        }

        function onCaptchaClaim() {
            document.getElementById('bag-captcha').style.display = 'none';
            apiCall('catch_fish', { captchaPassed: true });
        }

        async function openBoxSequence() {
            if (userData.boxes <= 0) return tg.showAlert("–ù–ï–¢ –î–û–°–¢–£–ü–ù–´–• –Ø–©–ò–ö–û–í!");
            
            const overlay = document.getElementById('box-overlay');
            const s1 = document.getElementById('box-stage-shake');
            const s2 = document.getElementById('box-stage-prize');
            
            overlay.style.display = 'flex';
            s1.style.display = 'block';
            s2.style.display = 'none';

            const result = await apiCall('open_box');

            setTimeout(() => {
                s1.style.display = 'none';
                s2.style.display = 'block';
                // –¢–ï–ü–ï–†–¨ –¢–£–¢ –ë–£–î–ï–¢ –°–£–ú–ú–ê, –ê –ù–ï UNDEFINED
                document.getElementById('prize-amount-text').innerText = `+${result.prize} TC`;
                tg.HapticFeedback.notificationOccurred('success');
            }, 2000);
        }

        function closeBoxUI() {
            document.getElementById('box-overlay').style.display = 'none';
            apiCall('load');
        }

        function copyReferral() {
            const link = `https://t.me/Tamacoin_bot?start=${userData.id}`;
            const input = document.createElement("input");
            document.body.appendChild(input);
            input.value = link;
            input.select();
            document.execCommand("copy");
            document.body.removeChild(input);
            tg.showAlert("–°–°–´–õ–ö–ê –°–ö–û–ü–ò–†–û–í–ê–ù–ê –í –ë–£–§–ï–†!");
        }

        // –ê–≤—Ç–æ-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
        setInterval(() => apiCall('load'), 20000);
        apiCall('load');
    </script>
</body>
</html>
