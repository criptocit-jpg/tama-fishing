<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tama Fishing</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: sans-serif; background: #1a2a6c; color: white; text-align: center; padding: 20px; }
        .btn { background: #4CAF50; border: none; color: white; padding: 15px; width: 100%; font-size: 18px; border-radius: 12px; margin: 10px 0; }
        #status { font-size: 14px; color: #ffeb3b; margin-top: 15px; padding: 10px; background: rgba(0,0,0,0.3); border-radius: 8px; }
    </style>
</head>
<body>
    <h1>üé£ Tamacoin Fishing</h1>
    <button class="btn" onclick="sendToBot('catch_fish')">–ó–ê–ë–†–û–° –£–î–û–ß–ö–ò</button>
    <button class="btn" style="background:#f44336" onclick="sendToBot('sell_fish')">–ü–†–û–î–ê–¢–¨ –£–õ–û–í</button>
    
    <div id="status">–°—Ç–∞—Ç—É—Å: –ì–æ—Ç–æ–≤ –∫ —Ä—ã–±–∞–ª–∫–µ</div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // –í–ù–ò–ú–ê–ù–ò–ï: –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ–±—ã —ç—Ç–∞ —Å—Å—ã–ª–∫–∞ —Å–æ–≤–ø–∞–¥–∞–ª–∞ —Å —Ç–≤–æ–µ–π –Ω–∞ Render!
        const SERVER_URL = 'https://tama-bot-server.onrender.com/api/action';

        async function sendToBot(actionName) {
            const statusDiv = document.getElementById('status');
            statusDiv.innerText = "–û—Ç–ø—Ä–∞–≤–∫–∞: " + actionName + "...";

            // –ë–µ—Ä–µ–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram
            const user = tg.initDataUnsafe?.user;
            if (!user) {
                statusDiv.innerText = "–û—à–∏–±–∫–∞: –ó–∞–ø—É—Å—Ç–∏ —á–µ—Ä–µ–∑ Telegram!";
                return;
            }

            try {
                const response = await fetch(SERVER_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        userId: user.id,
                        action: actionName
                    })
                });

                const result = await response.json();
                
                if (response.ok) {
                    statusDiv.innerText = "‚úÖ –£—Å–ø–µ—à–Ω–æ! –ü—Ä–æ–≤–µ—Ä—å —á–∞—Ç.";
                    // –î–æ–±–∞–≤–∏–º –ª–µ–≥–∫—É—é –≤–∏–±—Ä–∞—Ü–∏—é –ø—Ä–∏ —É—Å–ø–µ—Ö–µ
                    if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');
                } else {
                    statusDiv.innerText = "‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: " + response.status;
                }
            } catch (e) {
                statusDiv.innerText = "‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: " + e.message;
                console.error(e);
            }
        }
    </script>
</body>
</html>
